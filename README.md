# RSNA_data_preprocessing

![流程圖原始檔](https://viewer.diagrams.net/?tags=%7B%7D&highlight=0000ff&edit=_blank&layers=1&nav=1&title=rsna_data_preprocess.drawio#R7V1pj9tG0v41BnY%2FTKOv6uOjjzhvgM2ugQB7fTE0EmeGiEbUK3HssX%2F9VpNsiZdISiYlSmYSZCSSYpNdT9dd1W%2FE%2B%2BfXXzez9dPv0SJYvuF08fpGfHjDOVBG8Y878i09wg2D9MjjJlykx9j%2BwB%2Fh9yA7mP3w8SVcBNvChXEULeNwXTw4j1arYB4Xjs02m%2Bhr8bKHaFkcdT17DCoH%2FpjPltWj%2FwoX8VN6VFO6P%2F5%2FQfj4lI2s%2FInnmb82O7B9mi2ir7lD4pc34v0miuL00%2FPr%2B2DpJs9PS%2Fq7jwfO7p5rE6ziLj%2B4%2B%2FaV6vk%2FPn75Nfrt07%2B%2Bf1jY4ONddpcvs%2BVL9r7Zw8bf%2FAQ8bqKXdXZZsImD17ppn937y2n1udjubREmQfQcxJtveIm%2FkZ%2BxDCHM3%2BLrfrqZpZrwDDhPuem2Mrt4lpH5cXf%2F%2FVTgh2w26mfG%2Fu3rSuO8rN7%2F%2Frz47b%2F%2Fnf2bPnaZGaTo2n0MnxMMvXuKn3GIDww%2FupkKEURvl%2BHjCo%2FF0Tp39G%2Bz%2B2D5KdqGcRi5s%2FdRHEfPeMHSnXg3m%2F%2FpJn21eB8to00ylnhI%2FsFLksHebtcp1ikemfkvD%2BFrsPCX4PenOHaL5K2bCP5xvlhREiK9HsLVItiQOY7IPy5m8Qz%2FuONb%2FBvgIyaf77hcv959iZZuIj5yif9zSyfY3H0P13eMG7JePVZJ3QiyMnoaIAFEGgNUSaa1UNwUESIUUUxR4FRRLTRU8UIVMVwoZD9CWgBqq9A5dE3vSJIdkPRnEM%2BfMnquo3AVB5tfvuCsbjM87ZiHu2Ax2z45QidfcqDbxpvoz8CDZhWtHCgfwuUyhyOg7l8PtRwG54EbtAtI67EdvcTLcIWjezacQDO7ZHdzv2SeXx%2BdvCDRw0M4DxCLq3mwjrckxRheOBS0hKQEKDUamAQDWhWQBZYwwQViQzLOpJZVaIEhGgS1nBlOBRVCVaGlGGEaUarASgQYNQMhCyZkXQuyGJ5VVjIpmNKUGz5qYKl2YH19CuPgj%2FVs7r5%2FxSkvIaZEjvvZNpyTRTR%2FeXbzfhEa4D%2BoRIBVwC03koGpEkEQyVDbYNbgLAsrLkcDfZM0QGATg0LdaMmMAmBjJoGpIYFaxo73RW4Cc7RQ%2F%2F8S%2BRN328SKQb0LdYv1a8Jz%2FHn89Oj%2B%2FhGjjvaZf443s3Dl73q%2F8af%2F8uG39%2F%2F4%2Fa%2FVE%2F5Ioo%2B5Z%2FCHS9BAYsVH8vDsUIWzlrnyc7hYuGHe1cEv0Vt3ImQwjGlFGDWGWkOZQlYpjxXjzEjCNeqA%2BAF%2FTi%2FIbO0ZUBZs4wlk%2FYKsXaKPCGPem1IDskX45USMUU%2FF%2FcFl8BAfhuF29rxeBp%2B3L%2FfP4XaLyh%2BZb7%2FkwJY8ymBYS55tlEhDeUc0okhKCVpSCyW9RXAiAWWioChQlREVpKHyTbQwDJQAiyKTV5GGaNUIZYZw5JYqzYdCWp3jJI%2B0rqAZRtSWEFdkbxMQm4EomCSUCcrAcTRU4%2BSokSiORmImjvI8rh137ADuegPwZrua3aHlvpnNN7NVOFvePQXP0WbzhLi%2BWwQxWsWOl34P15dG9pjFOdrXgmprubXGCMFEickqQahQRiNwEfs1TJZTd4edS9KKGn%2F02bDdwakYrBZvXQDE0WU5Q3k7LxK3OO3Baxj%2F230mkH37T3ad%2B%2FzhNXfZh28nkSpYFCItVULljUBanVt%2FbBMsZ3H4pRifqZvhbIRPzuuVcy4rlKaK4XozSlm0REUnHucH2EYvm3mQ3XNPxaOHMUCEtgp5LDJbZbyJ4oeJZ5vHIK4MgwSdfctdlnj0tqe%2FrAaSvWZqkUMJmel4e5zuqPUD0K3zWvbEKdebwKHxMz7j7PMinEfPZP2tqzVTXA8tvpWhuBSTkijQXEgQlhprikaHpEC0plQB1WA5s1UuxTgRDGFMRRpAqS4kwwigTeIuBcOELCG8PybVwY14HJO6SobDjSZoRlqNhiJSTChdIKm1xOa9Feo0ftMyypn4TdtTXILfdHCk5lCYaTS3BkFwwQWlcd1zRf0N%2BkWg4JwoqyzVSF78q%2BCYUQ4AsDcU1HnZfjoUNC5OhnJBaqAgHbGE9J7343GAGhSCgXrAiaOGGRgIvM4T9vMJpRbFENULol0sh2s0lYzxUOlZCwZQZOf6VLo8ynmUYJAKT0s077jk9gwSide5yEoQnOL254rbM4GGv5EKrX5UqRVXJXQoQ9DW19QKrkGaDKIjDdx7JPXq5691Z813CNpfKIKZulfqSP9Z24D3%2BwNJuprLU1tvonmS1rYz7e5rnF1dfGCDTM7pN%2FrL24TIn%2F7%2BK%2F4fV2rw195ufUScb%2FIiHuIWmhKBPAHZgQQGGoqatBKK5A3rqnk%2Bopggr%2FOP%2F3yaUItW3Jcm1DbMWTShtoc4uybUwY09yiQnrlwKspSMagGM86Kpi5oEodIay0AmvuSqzjCeJCfeIYv0CmmgUC1TLDeDo6ZBnae0X82koh%2BdUY%2FbqW2pXz4tOWjXMupUujHrbv5G2%2FVsVXujE36SrLy7bbr03OjrTXDoTrNnty5X99v1ad%2F9HKcPU5n6%2FOEklyIJszhqTkkVTXyqpeQARTLPZfdU7csRpVTwwxmxE5%2Ba%2BNQI%2BVSwjSc21QObUs4NRnP5rmNmU2Ly8aeuS0u4YQYy72TRVyEEGnuSA1qCylhDTw37KSqJMymNtUpaK6ujMNB7a6iTXduXfelBOESuSeAc1SHiIREUnx%2BizfMs%2Flx1srmclE00D7ZbEq6%2Fre4PcqASQEeRjqI4EKGkAC4spwqKvnFuBVE8V1JVYQojykYRvafMXSVT0IIRpKuWON8u3ZEXl2tLmkhXptA8ihSSZFUTzFpQ0C0X4FhvV8tDcEmS6iAfii4hbAB3lzguFeVWIQgoE3CdJ%2F5zx2GKTAWxh3oEaMt0IjdO9LeCZsQCWlZUUuO8cJVB8JTAwVO0n1csDVhYuF0vw1QkXaO4oRqFgZcVurRiwbn0rJFOx3QCo6qDjkjcyEkHTXgwEwQY01YqgXzflJ20FJch6qdocqCmWL59Z2nTPIi1BLUXxaXmrqlIt3yjo4VN8zMYS5jVwqXFOYDK4YWN7QDAXG%2Bfrrg61PDniEUO2jnepRVgkpBpUSyDIloqToWlDhrVRc4UEDRPjVX%2BHlX0nstxLzrEUHsOnjQTu50K44yAiJ8kApK4oCaf4rh8ioUmDN0ci7fqS%2FxR7rIvtqvNifM5wBSlIaDQ1K7WRalqI5asO5dBMaC04NrUJMqcy51o67xIh1W5ttxxX2nna%2Btcnd2%2B6u6GKu3QuCdodSvnS7BcsqJKJI0mSUaNRraCBt%2BJ2ebGciIRKCrV%2BqU%2BZpCedD%2BDOgsaJZYjnKXyjeQaH2FY1e%2B4zK6bLHZoxoUGPEt33MOUev9dEny9gaDOyTAG%2FR81SYIGklFoAzjHcrG5I3J8IoywUtvEaKvm7VjNUbhAWoONy65Ga7WM6MNBh%2F5s%2FA6J%2FGfR%2Fk1nGngBDMRQrpxoTkveq2bWiIwD2dbJYUQK8CEr46QGOx1Nk52V8bDsJXnhCvPmr9r%2BeFh%2B3idUZaSbjJEfZ3Y71xxBhmeUFYwBMFuMUPOk1%2FA%2BtaHCCBF1rmjZCGooMCFr3E3nskTkgL0TDApy6BotuGm8ABEFyVdswcAtAZVvP32S6DwbYs4Qcmyc9pGYA6g1EmuAUsaUSlTPAlGBEqsVQ62UGyV8qsDRlc%2FAiHPxU8EA4VEqDmoeY2BrQJ0eDWgk74%2BbA0JptKGoxJUkQXFZXU5cWte3FySaDjTHoy%2Bh8XcwqqbS3fbS3WaMHhfEYGjJGwugUgfMJctvfcHfpQ3CI2bSd%2F5zyZ%2BS7ksbS32HDMnVQBtaoyUx4jqlgkUepxTXNWuUGwIS5aHWUlIh9UBEgA6sbqREAISp3leXypKQArLvmoEUGzUR%2BEFNdXQ24%2BVNduTLWdOyH4kPTmb7ec12R7U7R7W7N%2Frd6o3%2BMFntPTJDLdBqN%2Ft6gqIyzQxBbVtS5HSJYe6L2fMhRK1cR899AOpyVpjpvdR%2B367ToiqeDyRqNDebQonuy6dgE%2BKbOeXsim06hSBgaBAInwlUNrdUQtOkuI6XUzw7lzc484Rp17gs7WhVHsSgKUcRpDbpbnZWo85MGwANZ40c7zdShrrmnNwazZQEXurzSFjBQq1xG42okZCpy8cad2jLyw2uCVVUMZHlCBYXLLIMxrU1XCWdLmp0aEls3tuga%2BTGmZRo08F5N1IiuC0LKNul7xRTIpQkOSvG0Gr6z5iIMHzN861ZMpMRc2VGzGS%2FDMACkctJaayvcypwQMFIbv9SjmpBlQWOKOxY58wZVg71tOdDY6qRZkByClnVghxRCoztoI9dppqDuoIqikinWqqSoNcMcZ6Vl2tdV7GFWhixEhcLRbtVKqiR8%2BcK7dTVB49U0lxezk9JRtcm6F2Ske%2BGMuUYtUh7dTQbBGIS%2FseYcB03eIEPMtf0M58KPGppf7gU64dXEL%2FVJKOjAXPHHDV9dYvRtqibMJUUMqtdh5aqgjiiLCPdwRE5TJZRNu8j8UjjJBOjhGSSC1RZoFQJ0kyNzllG0nET8C1cS8BpGWRgj7Q%2BXU1tpG8faUacoI7JjQCpOWhbY3EZmVAPNVVXgKxVzQZvZ1JGdQfP3%2BTZP9Gzr7sz62xR3UlCC6uqpqPviJz3ukOW2jn8xkdMtM%2BAUYTv0iep2e3c7ZkbLlCwlKJ4tEk7heoaHpHjuG0n3BFZNJc3KKcUmGs0KhOLcjIme%2BaCRhCljQtQps3Nr9eWtENvu3YNVoFijAghDfcx6QI9WxpSdd5f4kdMj762l2h8hvoXHXbvR1ong%2FvE3xVUwjPXFc1Y4L4RYrEVngFJdruO7MB59EZvzYNoK0iuEB66bW%2FSHwym3p%2FJDwRKBrRbkQ0YYIaWmpQZPOs2LaKuowFjp2751zwISNS%2Bc40Xu5VBHb3lX%2FNDaEXJLmWPM3qGnhyMVl0j8%2FXn8Hn2GPhOjSVEjqIlo0WTDFxLxcwkO7Zbm7CMuN6rBjmEW%2Fk1PpWz7UdNq14VVuUDy2W43h7SAHMzPtuuU6fFQ%2FjqqFT2mixmgXmYVzRTPKPmJrh%2FGJBoLttQaVzCBrjVIEslrI4m0qo94Wp8YUhXmpjaYLQwu1acBTv6wDUDEK6qRtYw8BsgnHZSVIBrIKmF1abo201y4ncbKOsazX9UVGPVQixxm1SjlAjnUuJaIwVLqw0kJ6lATV1%2FVR45MrJVdWZ5k2RjSCpCXb42ZUqgDlx2NnLiW8Ym6ko1QWhkhJu03FT4uX4fEpchRV2WGp9p75kosthd3p1rQ3tiYQhaOi63iaEWKzha1OyoUYa2eNjhTiGp59O7wfY%2BwSzeclzLUza0e%2FRl9T1cX9pXOOYdaTl3W9JKNKVU6mEqlp0gZyOFRIKaDazHk0iAjzHxMDc5FokqPUWVKXrSlAXiW6Ynu6%2BcxsGaB0FjjmS7GCcOgU7861g7veU9QZL9S0K2%2B9ywZjrv0D3gZwCgMWiU45SDcR0FaFG6oXlC9i0aXT7FiQhsHIUjzAudloaBYOMzoBFGcj176Bk2RWYecX31G17h86S1wuC%2F%2Fie7MvmyrxNOvp3WczilRsNr%2BZcYCcBRJ2NE6Z2SqEq%2BUG3IjuYoE091hiq0IRQyFWaUslqX3eK1FQh9%2B0Kb39RmO5Wc%2BAqlnw%2B1JKa96juQ8kC5xdGgdaNYBL8r6xC7PjM7vQD5SLULzcmg7d306bKp%2FJQ7154715OTxW3TLqhmOjOVi%2ByDKU12QUG35VfNPu0jyqxjZ9ip%2FdaSupIQ13ZK67qitK58UfBdSr%2FjErw6Ufr68rv6YomNuRJccpI2pzDceTFtNc7DUDvN147omqjq2Vw2fMpVH5G8tSCJdqnN2qJAtbxcVgSE5VXEkUvbqffGJG1vXtq6JOoTpewkYg9wQUYJ2sOGWyUM17zoV746CTsFRVK9yRpimM4a8UEpFc3tKg2gpRFaMMrMiT7p5lEObHnft8uu8RmEdRug%2Bve0wFQJYkN44ESHuMik5Z3Nq6IERx3MaNTijETilEwIQANDMiV9tVxNb5sx6Xm%2BuesErlGAC4R23EfpbDdrXmS0nJNUcAIqZEaO3WUnOoTTJnCdkXMZIhml1pVEGcuuHFwdAlMTuM4GLi2ASImkT%2BP57Lqx1daRrEsOX2r8bVExjV%2FWZ7MMx5wwhxyIEmF35bGsGN8URpB8R%2B%2Bqi%2BzAfnIXMQ1FWzyqO0bizWy1fUjOTCBhro00cgqL%2FxkjRElMXRlIJg%2F9mISU4QLt97QazthSZ9irE1JtLvruDGgZIUkn7pNCRLqkK8c4OAheqkxp5z5giZICuQpII12C5iW5T9V76TqGbH82moJAqqls90lR6hApjNtmxCgAmm4SWXVJj0mi1HaEbl71SbBguAhQJX4yRURKWi9VCD8UKymIeKksXxT3ZKg2OBsV%2FNo2hD87%2FG60odF5sGctydUSmOp2IKPC3nG9Tm%2BzpQxIRTSzrjqDUV7OYJKon%2BwbfEjfUPjoSFzzKIoDsYgJI90mccyU3mLoCsvaNskTDgoLW0mS0ibt7XEqDFCbdRpx1hPB9xTrNMjgKJjComMyrQFQjaacSk6ppqVarnYdRyDQ8s1qagzr88mZDk6bn5y%2FJBKA74tUTy3SamYwLaMMzmGm2Pj1cJhWTXZUHKb3tLIdso7vSDYWjiMsJU5CSC0tc5psgcAtfQy7c5wmX5BiluT02vJL9NYir%2FFN6x9i2Bwz6L32%2FhYACUAE15RlWxeUMr04J7lsRHa6kt2EyJN07J4BeeBND7ehbLxb7RsNjO7japhvU6FTKD4tF1y6gnekQhFnwiDW924DI0%2FN4W0ZhqMhkA%2BydWtu0h8SjmvUdZtIMCCIEWnLDSWEnxNPIlyfu7YIlHl%2BdIJq7wKhVKHtJ3d97LqNMTgKJkdiC3364gZjBsHkReTMbZWrpXYdhKkGI8vR7p5g0DLMhYEwuXucTODEaFRCBVrAaP2WM%2FN6AkLLMBcGQn8JNQf29v6J82oSX57Uu73zirKAU0HSPuZZd7307EgDkaqDtbyfVnZg4nOUriFqpSmv%2FuWt%2BuUHLesj6CWtJsiqNSA9DOiSHo8Lmexo5YryqkkzklqS2n%2BQbktSw7wEJQyYkcIwrY3fMax%2FgkGdv62Yf5AkGuRWNhui3lx2rDfXwUwFtPoEf%2F%2FnxyWSuo%2Fi8lbu052rbAJ8xWyDyJ0bPKEhvHsDH9y9XuIom%2BFjGNtwzKixEoa5vq5UKBRUaVkrr4Db1IhiX6c5AL%2BpBiLm0eohfCTrbw2M5xJ7V%2Bz4AxHIOai1Osn259UySNeKxW20yyhqF1TJGoZ%2Btu0pPHfLTTCt6oA30HjdovqF8DZMIU0MpTVkOU9jdfy6iRxv22twLqz0e7QI3BX%2FAw%3D%3D)

![流程圖](https://github.com/MingChin-Kao/RSNA_data_preprocessing/blob/main/images/flow_chart.png)

### Step1. 從 [Kaggle](https://www.kaggle.com/competitions/rsna-intracranial-hemorrhage-detection/overview) 下載檔案，並解壓縮得到以下資料夾

---

- stage_2_test/ (DICOM File)
- stage_2_train/ (DICOM File)
- stage_2_sample_submission.csv
- stage_2_train.csv

### Step2. 環境建置

---

下載此 repo 並透過 requirements.txt 進行環境建置

- Python=3.8

```bash
pip install -r requirements.txt
```

### Step3. 設定 [config.py](http://config.py) 檔

---

於 [config.py](http://config.py) 檔案中設定 `RSNA_ROOT_DIR` 及 `ZIP_FILE` 路徑

- `RSNA_ROOT` ⇒ Step1 下載下來解壓縮的資料夾位置
- `ZIP_FILE` ⇒ Step1 下載下來的 zip 檔位置

### Step4. 執行 [config.py](http://config.py) 檔案

---

執行 [config.py](http://config.py) 檔案用來建立所需資料夾

```bash
python config.py
```

### Step5. 執行 prepare_meta_dicom.py

---

- 將所有 DICOM 轉成 PNG 檔
- 產生 train_metadata.csv
- 產生 test_metadata.csv

### Step6. 執行 efficient_data_format_preprocess.ipynb

---

- 透過 efficient_data_format_preprocess.ipynb 將csv資料轉成 efficientnet 訓練需要的格式
- 產生 train.csv

### Step7. 執行 split_data.ipynb

---

- 透過 split_data.ipynb 將訓練資料進行切割

### Step8. 執行 split_data.ipynb

---

- 透過 cp_image.ipynb 將客戶端對應的資料複製出來
- 將每個 site 所屬的照片複製一份至 /fl/site_images/ 資料夾中
- 將 test_data 所屬的圖片複製一份至 /fl/site_images/ 資料夾中

### Training

---

[點我](https://www.kaggle.com/code/taindow/pytorch-efficientnet-b0-benchmark/notebook?scriptVersionId=21235680)
